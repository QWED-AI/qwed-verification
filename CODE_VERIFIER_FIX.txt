# Fix for code_verifier.py - Lines 38-85
# Replace lines 38-85 in code_verifier.py with this exact content:

    # CRITICAL: Always dangerous (auto-block)
    CRITICAL_FUNCTIONS = {
        "eval", "exec", "compile", "__import__",
        "pickle.loads", "pickle.load",
        "yaml.unsafe_load",
        "getattr",  # Can execute arbitrary methods
    }
    
    # Weak cryptographic functions (CRITICAL for passwords)
    WEAK_CRYPTO_FUNCTIONS = {
        "hashlib.md5", "hashlib.sha1",  # Broken for passwords
    }
    
    # Password-related variable names
    PASSWORD_INDICATORS = {
        "password", "passwd", "pwd", "pass",
        "credential", "cred", "auth",
        "secret", "token", "key"
    }
    
    # Dangerous pandas/dataframe methods (execute eval internally)
    DANGEROUS_DATAFRAME_METHODS = {
        "eval", "query"  # df.eval() and df.query() use eval() internally
    }
    
    # WARNING: Context-dependent (manual review)
    WARNING_FUNCTIONS = {
        # File operations (safe if hardcoded, risky if user input)
        "open",
        # OS operations
        "os.system", "os.popen", "os.spawn", "os.spawnl", "os.spawnv",
        "os.remove", "os.unlink", "os.rmdir", "os.removedirs",
        "os.rename", "os.chmod", "os.chown", "os.kill", "os.fork",
        # Subprocess
        "subprocess.call", "subprocess.Popen", "subprocess.run", "subprocess.check_output",
        # File operations
        "shutil.rmtree", "shutil.move", "shutil.copy", "shutil.copyfile",
        # Network
        "socket.socket", "socket.create_connection",
        "urllib.request.urlopen", "urllib.request.urlretrieve",
        "requests.get", "requests.post",
        "http.client.HTTPConnection", "http.client.HTTPSConnection",
    }
    
    # Dangerous modules (import triggers WARNING)
    DANGEROUS_MODULES = {
        "telnetlib", "ftplib",
        "os", "subprocess", "shutil",
        "socket", "urllib", "http.client", "requests",
        "pickle", "marshal",
        "importlib", "imp",
    }
    
    # Dangerous attributes
    DANGEROUS_ATTRIBUTES = {
        "__class__", "__base__", "__subclasses__", "__globals__",
        "__builtins__", "__import__", "__code__", "__dict__"
    }
    
    # User input indicators (for context-aware detection)
    USER_INPUT_INDICATORS = {
        "input", "raw_input",  # Direct user input
        "request", "req",      # Web requests
        "argv", "args",        # Command-line args
        "environ", "getenv",   # Environment variables
    }
    
    def verify_code(self, code: str, language: str = "python") -> Dict[str, Any]:
